===================== Inference Activations ======================
--------------------------
Inference example 7
input t
[[[[1.e+00 1.e+00]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]]

  [[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]]]


 [[[1.e+00 1.e+00]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]]

  [[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]]]]
output t
[[6.0113825e-02 1.6879208e-21 1.5545099e-21 5.9336368e-02 5.9925709e-02
  5.9207406e-02 5.8634292e-02 6.0053948e-02 5.9794720e-02 1.7550695e-21
  6.0842555e-02 1.7164876e-21 6.0763050e-02 6.1313231e-02 6.0740519e-02
  6.1221335e-02 6.0767870e-02 6.1277885e-02 6.0886938e-02 6.0739059e-02
  1.4275554e-21 1.4179501e-21 1.7363486e-21]
 [3.5435800e-04 1.9916171e-01 2.9459602e-04 4.5263384e-21 1.4357232e-03
  8.5766031e-04 4.5263384e-21 4.5263384e-21 1.2706741e-03 1.9753957e-01
  1.1439148e-03 2.9326510e-01 4.5263384e-21 1.4346311e-03 1.2764634e-03
  2.0226667e-02 4.5263384e-21 4.5263384e-21 2.0228412e-02 4.5263384e-21
  2.9589194e-01 4.5263384e-21 4.5263384e-21]]

=========================
Layer 0 encoder
z
[[0.5 0.5]
 [0.5 0.5]]

u
[[[0.5 0.5]
  [0.5 0.5]]

 [[0.5 0.5]
  [0.5 0.5]]]

v
[[0.5 0.5]
 [0.5 0.5]]

y_categorical
[[0.49999994 0.5       ]]

y_bernoulli
[[0.50000006 0.5       ]
 [0.49999994 0.5       ]]

rho_categorical
[[0.14242183 0.98469204]
 [0.34497488 0.7756434 ]]

x_categorical
[[0.195878 0.848746]]

x_bernoulli
[[0.804122 0.151254]
 [0.195878 0.848746]]

z_prime
[[0.5 0.5]
 [0.5 0.5]]

=========================
Layer 1 encoder
z
[[0.5 0.5]
 [0.5 0.5]]

u
[[[0.5 0.5]
  [0.5 0.5]]

 [[0.5 0.5]
  [0.5 0.5]]]

v
[[0.5 0.5]
 [0.5 0.5]]

y_categorical
[[2.1076817e-20 1.0000000e+00]]

y_bernoulli
[[1.0000000e+00 0.0000000e+00]
 [2.1076817e-20 1.0000000e+00]]

rho_categorical
[[9.5509582e-09 1.0848480e-08]
 [7.8506601e-01 6.3620085e-01]]

x_categorical
[[0.684746   0.63620085]]

x_bernoulli
[[0.31525397 0.36379915]
 [0.684746   0.63620085]]

z_prime
[[1.0000000e+00 0.0000000e+00]
 [4.5779813e-20 1.0000000e+00]]

====================
Layer 1 decoder
x_bernoulli
[[1. 0.]
 [0. 1.]]

y_bernoulli
[[1.000000e+00 0.000000e+00]
 [9.943584e-20 1.000000e+00]]

x_categorical
[[0. 1.]]

y_categorical
[[9.943584e-20 1.000000e+00]]

v
[[4.7235412e-20 6.2553328e-01]
 [9.9999997e-21 1.0000000e+00]]

rho_categorical
[[0.        0.9656186]
 [0.        0.0343814]]

t_categorical
[[[0.0000000e+00 6.0113825e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 5.9336368e-02]
  [0.0000000e+00 5.9925709e-02]
  [0.0000000e+00 5.9207406e-02]
  [0.0000000e+00 5.8634292e-02]
  [0.0000000e+00 6.0053948e-02]
  [0.0000000e+00 5.9794720e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 6.0842555e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 6.0763050e-02]
  [0.0000000e+00 6.1313231e-02]
  [0.0000000e+00 6.0740519e-02]
  [0.0000000e+00 6.1221335e-02]
  [0.0000000e+00 6.0767870e-02]
  [0.0000000e+00 6.1277885e-02]
  [0.0000000e+00 6.0886938e-02]
  [0.0000000e+00 6.0739059e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]]

 [[0.0000000e+00 3.5435800e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 2.9459602e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.4357232e-03]
  [0.0000000e+00 8.5766031e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.2706741e-03]
  [0.0000000e+00 1.1884022e-02]
  [0.0000000e+00 1.1439148e-03]
  [0.0000000e+00 8.0503020e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.4346311e-03]
  [0.0000000e+00 1.2764634e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 6.3790530e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]]]

u
[[[1.0000000e+00 3.7446672e-01]
  [1.0000000e+00 0.0000000e+00]]

 [[4.7235412e-20 6.2553328e-01]
  [9.9999997e-21 1.0000000e+00]]]

z
[[0.37446672 0.        ]
 [0.6255333  1.        ]]

====================
Layer 0 decoder
x_bernoulli
[[0.37446675 0.        ]
 [0.6255332  1.        ]]

y_bernoulli
[[0.71077627 0.        ]
 [0.2892237  1.        ]]

x_categorical
[[0.6255332 1.       ]]

y_categorical
[[0.2892237 1.       ]]

v
[[0.27861017 0.03669661]
 [0.2762512  0.04485285]]

rho_categorical
[[8.4310990e-21 1.0362869e-20]
 [3.8481724e-01 6.1518276e-01]]

t_categorical
[[[6.6306811e-22 8.8841995e-22]
  [0.0000000e+00 7.6253032e-22]
  [0.0000000e+00 6.2911942e-22]
  [1.3419357e-21 1.4720266e-22]
  [7.1553178e-22 2.1552288e-22]
  [8.9902042e-22 6.2022703e-22]
  [1.5862426e-21 2.2427974e-22]
  [7.0641401e-22 2.1328888e-22]
  [1.0757054e-21 8.0710442e-22]
  [1.6143857e-22 6.6824046e-22]
  [5.7534849e-22 4.0989175e-23]
  [0.0000000e+00 7.9109713e-22]
  [9.2317249e-23 3.5063817e-22]
  [0.0000000e+00 4.7587659e-22]
  [0.0000000e+00 1.0972535e-22]
  [1.4226562e-23 2.9957295e-22]
  [0.0000000e+00 8.3321877e-22]
  [0.0000000e+00 1.5367886e-22]
  [6.9142592e-23 1.5653731e-23]
  [5.3070760e-22 3.1079926e-22]
  [0.0000000e+00 5.0216502e-22]
  [0.0000000e+00 4.9255970e-22]
  [0.0000000e+00 8.1095830e-22]]

 [[1.6530355e-21 2.7924590e-21]
  [1.9916171e-01 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.8565555e-01 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.8521481e-01]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.0226667e-02]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.0228412e-02]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.8951290e-01]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]]]

u
[[[0.72138983 0.9633034 ]
  [0.7237488  0.95514715]]

 [[0.27861017 0.03669661]
  [0.2762512  0.04485285]]]

z
[[0.69491726 0.6912866 ]
 [0.30508274 0.30871338]]

--------------------------
--------------------------
Inference example 6
input t
[[[[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]]

  [[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]]]


 [[[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]]

  [[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]]]]
output t
[[6.0113825e-02 1.6879208e-21 1.5545099e-21 5.9336368e-02 5.9925709e-02
  5.9207406e-02 5.8634292e-02 6.0053948e-02 5.9794720e-02 1.7550695e-21
  6.0842555e-02 1.7164876e-21 6.0763050e-02 6.1313231e-02 6.0740519e-02
  6.1221335e-02 6.0767870e-02 6.1277885e-02 6.0886938e-02 6.0739059e-02
  1.4275554e-21 1.4179501e-21 1.7363486e-21]
 [3.5435800e-04 1.9916171e-01 2.9459602e-04 4.5263384e-21 1.4357232e-03
  8.5766031e-04 4.5263384e-21 4.5263384e-21 1.2706741e-03 1.9753957e-01
  1.1439148e-03 2.9326510e-01 4.5263384e-21 1.4346311e-03 1.2764634e-03
  2.0226667e-02 4.5263384e-21 4.5263384e-21 2.0228412e-02 4.5263384e-21
  2.9589194e-01 4.5263384e-21 4.5263384e-21]]

=========================
Layer 0 encoder
z
[[0.5 0.5]
 [0.5 0.5]]

u
[[[0.5 0.5]
  [0.5 0.5]]

 [[0.5 0.5]
  [0.5 0.5]]]

v
[[0.5 0.5]
 [0.5 0.5]]

y_categorical
[[0.49999994 0.5       ]]

y_bernoulli
[[0.50000006 0.5       ]
 [0.49999994 0.5       ]]

rho_categorical
[[0.61107856 0.365581  ]
 [0.34497488 0.7756434 ]]

x_categorical
[[0.5408506  0.63224804]]

x_bernoulli
[[0.45914942 0.36775196]
 [0.5408506  0.63224804]]

z_prime
[[0.5 0.5]
 [0.5 0.5]]

=========================
Layer 1 encoder
z
[[0.5 0.5]
 [0.5 0.5]]

u
[[[0.5 0.5]
  [0.5 0.5]]

 [[0.5 0.5]
  [0.5 0.5]]]

v
[[0.5 0.5]
 [0.5 0.5]]

y_categorical
[[2.1076817e-20 1.0000000e+00]]

y_bernoulli
[[1.0000000e+00 0.0000000e+00]
 [2.1076817e-20 1.0000000e+00]]

rho_categorical
[[1.3366339  0.06203758]
 [0.785066   0.63620085]]

x_categorical
[[0.8555484  0.63620085]]

x_bernoulli
[[0.14445162 0.36379915]
 [0.8555484  0.63620085]]

z_prime
[[1.0000000e+00 0.0000000e+00]
 [1.2483236e-19 1.0000000e+00]]

====================
Layer 1 decoder
x_bernoulli
[[1. 0.]
 [0. 1.]]

y_bernoulli
[[1.0000000e+00 0.0000000e+00]
 [7.3934877e-19 1.0000000e+00]]

x_categorical
[[0. 1.]]

y_categorical
[[7.3934877e-19 1.0000000e+00]]

v
[[2.868615e-19 6.255333e-01]
 [1.000000e-20 1.000000e+00]]

rho_categorical
[[0.        0.9656186]
 [0.        0.0343814]]

t_categorical
[[[0.0000000e+00 6.0113825e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 5.9336368e-02]
  [0.0000000e+00 5.9925709e-02]
  [0.0000000e+00 5.9207406e-02]
  [0.0000000e+00 5.8634292e-02]
  [0.0000000e+00 6.0053948e-02]
  [0.0000000e+00 5.9794720e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 6.0842555e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 6.0763050e-02]
  [0.0000000e+00 6.1313231e-02]
  [0.0000000e+00 6.0740519e-02]
  [0.0000000e+00 6.1221335e-02]
  [0.0000000e+00 6.0767870e-02]
  [0.0000000e+00 6.1277885e-02]
  [0.0000000e+00 6.0886938e-02]
  [0.0000000e+00 6.0739059e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]]

 [[0.0000000e+00 3.5435800e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 2.9459602e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.4357232e-03]
  [0.0000000e+00 8.5766031e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.2706741e-03]
  [0.0000000e+00 1.1884022e-02]
  [0.0000000e+00 1.1439148e-03]
  [0.0000000e+00 8.0503020e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.4346311e-03]
  [0.0000000e+00 1.2764634e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 6.3790530e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]]]

u
[[[1.0000000e+00 3.7446672e-01]
  [1.0000000e+00 0.0000000e+00]]

 [[2.8686151e-19 6.2553328e-01]
  [9.9999997e-21 1.0000000e+00]]]

z
[[0.37446672 0.        ]
 [0.6255333  1.        ]]

====================
Layer 0 decoder
x_bernoulli
[[0.37446675 0.        ]
 [0.6255332  1.        ]]

y_bernoulli
[[0.33696046 0.        ]
 [0.6630395  1.        ]]

x_categorical
[[0.6255332 1.       ]]

y_categorical
[[0.6630395 1.       ]]

v
[[0.6387082  0.03669661]
 [0.6333003  0.04485285]]

rho_categorical
[[8.4310990e-21 1.0362869e-20]
 [3.8481724e-01 6.1518276e-01]]

t_categorical
[[[6.6306811e-22 8.8841995e-22]
  [0.0000000e+00 7.6253032e-22]
  [0.0000000e+00 6.2911942e-22]
  [1.3419357e-21 1.4720266e-22]
  [7.1553178e-22 2.1552288e-22]
  [8.9902042e-22 6.2022703e-22]
  [1.5862426e-21 2.2427974e-22]
  [7.0641401e-22 2.1328888e-22]
  [1.0757054e-21 8.0710442e-22]
  [1.6143857e-22 6.6824046e-22]
  [5.7534849e-22 4.0989175e-23]
  [0.0000000e+00 7.9109713e-22]
  [9.2317249e-23 3.5063817e-22]
  [0.0000000e+00 4.7587659e-22]
  [0.0000000e+00 1.0972535e-22]
  [1.4226562e-23 2.9957295e-22]
  [0.0000000e+00 8.3321877e-22]
  [0.0000000e+00 1.5367886e-22]
  [6.9142592e-23 1.5653731e-23]
  [5.3070760e-22 3.1079926e-22]
  [0.0000000e+00 5.0216502e-22]
  [0.0000000e+00 4.9255970e-22]
  [0.0000000e+00 8.1095830e-22]]

 [[1.6530355e-21 2.7924590e-21]
  [1.9916171e-01 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.8565555e-01 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.8521481e-01]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.0226667e-02]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.0228412e-02]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.8951290e-01]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]]]

u
[[[0.36129183 0.9633034 ]
  [0.3666997  0.95514715]]

 [[0.6387082  0.03669661]
  [0.6333003  0.04485285]]]

z
[[0.34803364 0.35025218]
 [0.65196633 0.64974785]]

--------------------------
--------------------------
Inference example 5
input t
[[[[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]
   [1.e-09 1.e-09]]

  [[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]]]


 [[[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]
   [1.e-09 1.e-09]]

  [[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]]]]
output t
[[6.0113825e-02 1.6879208e-21 1.5545099e-21 5.9336368e-02 5.9925709e-02
  5.9207406e-02 5.8634292e-02 6.0053948e-02 5.9794720e-02 1.7550695e-21
  6.0842555e-02 1.7164876e-21 6.0763050e-02 6.1313231e-02 6.0740519e-02
  6.1221335e-02 6.0767870e-02 6.1277885e-02 6.0886938e-02 6.0739059e-02
  1.4275554e-21 1.4179501e-21 1.7363486e-21]
 [3.5435800e-04 1.9916171e-01 2.9459602e-04 4.5263384e-21 1.4357232e-03
  8.5766031e-04 4.5263384e-21 4.5263384e-21 1.2706741e-03 1.9753957e-01
  1.1439148e-03 2.9326510e-01 4.5263384e-21 1.4346311e-03 1.2764634e-03
  2.0226667e-02 4.5263384e-21 4.5263384e-21 2.0228412e-02 4.5263384e-21
  2.9589194e-01 4.5263384e-21 4.5263384e-21]]

=========================
Layer 0 encoder
z
[[0.5 0.5]
 [0.5 0.5]]

u
[[[0.5 0.5]
  [0.5 0.5]]

 [[0.5 0.5]
  [0.5 0.5]]]

v
[[0.5 0.5]
 [0.5 0.5]]

y_categorical
[[0.49999994 0.5       ]]

y_bernoulli
[[0.50000006 0.5       ]
 [0.49999994 0.5       ]]

rho_categorical
[[0.08330192 0.58444357]
 [0.34497488 0.7756434 ]]

x_categorical
[[0.15236056 0.70878243]]

x_bernoulli
[[0.84763944 0.29121757]
 [0.15236056 0.70878243]]

z_prime
[[0.5 0.5]
 [0.5 0.5]]

=========================
Layer 1 encoder
z
[[0.5 0.5]
 [0.5 0.5]]

u
[[[0.5 0.5]
  [0.5 0.5]]

 [[0.5 0.5]
  [0.5 0.5]]]

v
[[0.5 0.5]
 [0.5 0.5]]

y_categorical
[[2.1076817e-20 1.0000000e+00]]

y_bernoulli
[[1.0000000e+00 0.0000000e+00]
 [2.1076817e-20 1.0000000e+00]]

rho_categorical
[[0.9538975  0.59721076]
 [0.785066   0.63620085]]

x_categorical
[[0.8066402  0.63620085]]

x_bernoulli
[[0.19335979 0.36379915]
 [0.8066402  0.63620085]]

z_prime
[[1.000000e+00 0.000000e+00]
 [8.792629e-20 1.000000e+00]]

====================
Layer 1 decoder
x_bernoulli
[[1. 0.]
 [0. 1.]]

y_bernoulli
[[1.0000000e+00 0.0000000e+00]
 [3.6680262e-19 1.0000000e+00]]

x_categorical
[[0. 1.]]

y_categorical
[[3.6680262e-19 1.0000000e+00]]

v
[[1.4735538e-19 6.2553328e-01]
 [9.9999997e-21 1.0000000e+00]]

rho_categorical
[[0.        0.9656186]
 [0.        0.0343814]]

t_categorical
[[[0.0000000e+00 6.0113825e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 5.9336368e-02]
  [0.0000000e+00 5.9925709e-02]
  [0.0000000e+00 5.9207406e-02]
  [0.0000000e+00 5.8634292e-02]
  [0.0000000e+00 6.0053948e-02]
  [0.0000000e+00 5.9794720e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 6.0842555e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 6.0763050e-02]
  [0.0000000e+00 6.1313231e-02]
  [0.0000000e+00 6.0740519e-02]
  [0.0000000e+00 6.1221335e-02]
  [0.0000000e+00 6.0767870e-02]
  [0.0000000e+00 6.1277885e-02]
  [0.0000000e+00 6.0886938e-02]
  [0.0000000e+00 6.0739059e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]]

 [[0.0000000e+00 3.5435800e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 2.9459602e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.4357232e-03]
  [0.0000000e+00 8.5766031e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.2706741e-03]
  [0.0000000e+00 1.1884022e-02]
  [0.0000000e+00 1.1439148e-03]
  [0.0000000e+00 8.0503020e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.4346311e-03]
  [0.0000000e+00 1.2764634e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 6.3790530e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]]]

u
[[[1.0000000e+00 3.7446672e-01]
  [1.0000000e+00 0.0000000e+00]]

 [[1.4735538e-19 6.2553328e-01]
  [9.9999997e-21 1.0000000e+00]]]

z
[[0.37446672 0.        ]
 [0.6255333  1.        ]]

====================
Layer 0 decoder
x_bernoulli
[[0.37446675 0.        ]
 [0.6255332  1.        ]]

y_bernoulli
[[0.76907647 0.        ]
 [0.23092349 1.        ]]

x_categorical
[[0.6255332 1.       ]]

y_categorical
[[0.2309235 1.       ]]

v
[[0.22244939 0.03669661]
 [0.22056593 0.04485285]]

rho_categorical
[[8.4310990e-21 1.0362869e-20]
 [3.8481724e-01 6.1518276e-01]]

t_categorical
[[[6.6306811e-22 8.8841995e-22]
  [0.0000000e+00 7.6253032e-22]
  [0.0000000e+00 6.2911942e-22]
  [1.3419357e-21 1.4720266e-22]
  [7.1553178e-22 2.1552288e-22]
  [8.9902042e-22 6.2022703e-22]
  [1.5862426e-21 2.2427974e-22]
  [7.0641401e-22 2.1328888e-22]
  [1.0757054e-21 8.0710442e-22]
  [1.6143857e-22 6.6824046e-22]
  [5.7534849e-22 4.0989175e-23]
  [0.0000000e+00 7.9109713e-22]
  [9.2317249e-23 3.5063817e-22]
  [0.0000000e+00 4.7587659e-22]
  [0.0000000e+00 1.0972535e-22]
  [1.4226562e-23 2.9957295e-22]
  [0.0000000e+00 8.3321877e-22]
  [0.0000000e+00 1.5367886e-22]
  [6.9142592e-23 1.5653731e-23]
  [5.3070760e-22 3.1079926e-22]
  [0.0000000e+00 5.0216502e-22]
  [0.0000000e+00 4.9255970e-22]
  [0.0000000e+00 8.1095830e-22]]

 [[1.6530355e-21 2.7924590e-21]
  [1.9916171e-01 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.8565555e-01 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.8521481e-01]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.0226667e-02]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.0228412e-02]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.8951290e-01]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]]]

u
[[[0.7775506  0.9633034 ]
  [0.7794341  0.95514715]]

 [[0.22244939 0.03669661]
  [0.22056593 0.04485285]]]

z
[[0.7490171  0.74447423]
 [0.25098288 0.25552577]]

--------------------------
--------------------------
Inference example 4
input t
[[[[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]]

  [[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]]]


 [[[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]]

  [[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]]]]
output t
[[6.0113825e-02 1.6879208e-21 1.5545099e-21 5.9336368e-02 5.9925709e-02
  5.9207406e-02 5.8634292e-02 6.0053948e-02 5.9794720e-02 1.7550695e-21
  6.0842555e-02 1.7164876e-21 6.0763050e-02 6.1313231e-02 6.0740519e-02
  6.1221335e-02 6.0767870e-02 6.1277885e-02 6.0886938e-02 6.0739059e-02
  1.4275554e-21 1.4179501e-21 1.7363486e-21]
 [3.5435800e-04 1.9916171e-01 2.9459602e-04 4.5263384e-21 1.4357232e-03
  8.5766031e-04 4.5263384e-21 4.5263384e-21 1.2706741e-03 1.9753957e-01
  1.1439148e-03 2.9326510e-01 4.5263384e-21 1.4346311e-03 1.2764634e-03
  2.0226667e-02 4.5263384e-21 4.5263384e-21 2.0228412e-02 4.5263384e-21
  2.9589194e-01 4.5263384e-21 4.5263384e-21]]

=========================
Layer 0 encoder
z
[[0.5 0.5]
 [0.5 0.5]]

u
[[[0.5 0.5]
  [0.5 0.5]]

 [[0.5 0.5]
  [0.5 0.5]]]

v
[[0.5 0.5]
 [0.5 0.5]]

y_categorical
[[0.49999994 0.5       ]]

y_bernoulli
[[0.50000006 0.5       ]
 [0.49999994 0.5       ]]

rho_categorical
[[0.52183235 0.66645473]
 [0.34497488 0.7756434 ]]

x_categorical
[[0.4751575 0.7374611]]

x_bernoulli
[[0.5248425 0.2625389]
 [0.4751575 0.7374611]]

z_prime
[[0.5 0.5]
 [0.5 0.5]]

=========================
Layer 1 encoder
z
[[0.5 0.5]
 [0.5 0.5]]

u
[[[0.5 0.5]
  [0.5 0.5]]

 [[0.5 0.5]
  [0.5 0.5]]]

v
[[0.5 0.5]
 [0.5 0.5]]

y_categorical
[[2.1076817e-20 1.0000000e+00]]

y_bernoulli
[[1.0000000e+00 0.0000000e+00]
 [2.1076817e-20 1.0000000e+00]]

rho_categorical
[[0.43385768 0.5706626 ]
 [0.785066   0.63620085]]

x_categorical
[[0.7401867  0.63620085]]

x_bernoulli
[[0.2598133  0.36379915]
 [0.7401867  0.63620085]]

z_prime
[[1.0000000e+00 0.0000000e+00]
 [6.0046113e-20 1.0000000e+00]]

====================
Layer 1 decoder
x_bernoulli
[[1. 0.]
 [0. 1.]]

y_bernoulli
[[1.0000000e+00 0.0000000e+00]
 [1.7106643e-19 1.0000000e+00]]

x_categorical
[[0. 1.]]

y_categorical
[[1.7106643e-19 1.0000000e+00]]

v
[[7.405868e-20 6.255333e-01]
 [1.000000e-20 1.000000e+00]]

rho_categorical
[[0.        0.9656186]
 [0.        0.0343814]]

t_categorical
[[[0.0000000e+00 6.0113825e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 5.9336368e-02]
  [0.0000000e+00 5.9925709e-02]
  [0.0000000e+00 5.9207406e-02]
  [0.0000000e+00 5.8634292e-02]
  [0.0000000e+00 6.0053948e-02]
  [0.0000000e+00 5.9794720e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 6.0842555e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 6.0763050e-02]
  [0.0000000e+00 6.1313231e-02]
  [0.0000000e+00 6.0740519e-02]
  [0.0000000e+00 6.1221335e-02]
  [0.0000000e+00 6.0767870e-02]
  [0.0000000e+00 6.1277885e-02]
  [0.0000000e+00 6.0886938e-02]
  [0.0000000e+00 6.0739059e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]]

 [[0.0000000e+00 3.5435800e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 2.9459602e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.4357232e-03]
  [0.0000000e+00 8.5766031e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.2706741e-03]
  [0.0000000e+00 1.1884022e-02]
  [0.0000000e+00 1.1439148e-03]
  [0.0000000e+00 8.0503020e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.4346311e-03]
  [0.0000000e+00 1.2764634e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 6.3790530e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]]]

u
[[[1.0000000e+00 3.7446672e-01]
  [1.0000000e+00 0.0000000e+00]]

 [[7.4058682e-20 6.2553328e-01]
  [9.9999997e-21 1.0000000e+00]]]

z
[[0.37446672 0.        ]
 [0.6255333  1.        ]]

====================
Layer 0 decoder
x_bernoulli
[[0.37446675 0.        ]
 [0.6255332  1.        ]]

y_bernoulli
[[0.39803734 0.        ]
 [0.6019627  1.        ]]

x_categorical
[[0.6255332 1.       ]]

y_categorical
[[0.6019627 1.       ]]

v
[[0.57987267 0.03669661]
 [0.5749629  0.04485285]]

rho_categorical
[[8.4310990e-21 1.0362869e-20]
 [3.8481724e-01 6.1518276e-01]]

t_categorical
[[[6.6306811e-22 8.8841995e-22]
  [0.0000000e+00 7.6253032e-22]
  [0.0000000e+00 6.2911942e-22]
  [1.3419357e-21 1.4720266e-22]
  [7.1553178e-22 2.1552288e-22]
  [8.9902042e-22 6.2022703e-22]
  [1.5862426e-21 2.2427974e-22]
  [7.0641401e-22 2.1328888e-22]
  [1.0757054e-21 8.0710442e-22]
  [1.6143857e-22 6.6824046e-22]
  [5.7534849e-22 4.0989175e-23]
  [0.0000000e+00 7.9109713e-22]
  [9.2317249e-23 3.5063817e-22]
  [0.0000000e+00 4.7587659e-22]
  [0.0000000e+00 1.0972535e-22]
  [1.4226562e-23 2.9957295e-22]
  [0.0000000e+00 8.3321877e-22]
  [0.0000000e+00 1.5367886e-22]
  [6.9142592e-23 1.5653731e-23]
  [5.3070760e-22 3.1079926e-22]
  [0.0000000e+00 5.0216502e-22]
  [0.0000000e+00 4.9255970e-22]
  [0.0000000e+00 8.1095830e-22]]

 [[1.6530355e-21 2.7924590e-21]
  [1.9916171e-01 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.8565555e-01 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.8521481e-01]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.0226667e-02]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.0228412e-02]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.8951290e-01]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]]]

u
[[[0.42012733 0.9633034 ]
  [0.4250371  0.95514715]]

 [[0.57987267 0.03669661]
  [0.5749629  0.04485285]]]

z
[[0.40471008 0.40597296]
 [0.59528995 0.59402704]]

--------------------------
--------------------------
Inference example 3
input t
[[[[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]]

  [[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]]]


 [[[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]]

  [[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]]]]
output t
[[6.0113825e-02 1.6879208e-21 1.5545099e-21 5.9336368e-02 5.9925709e-02
  5.9207406e-02 5.8634292e-02 6.0053948e-02 5.9794720e-02 1.7550695e-21
  6.0842555e-02 1.7164876e-21 6.0763050e-02 6.1313231e-02 6.0740519e-02
  6.1221335e-02 6.0767870e-02 6.1277885e-02 6.0886938e-02 6.0739059e-02
  1.4275554e-21 1.4179501e-21 1.7363486e-21]
 [3.5435800e-04 1.9916171e-01 2.9459602e-04 4.5263384e-21 1.4357232e-03
  8.5766031e-04 4.5263384e-21 4.5263384e-21 1.2706741e-03 1.9753957e-01
  1.1439148e-03 2.9326510e-01 4.5263384e-21 1.4346311e-03 1.2764634e-03
  2.0226667e-02 4.5263384e-21 4.5263384e-21 2.0228412e-02 4.5263384e-21
  2.9589194e-01 4.5263384e-21 4.5263384e-21]]

=========================
Layer 0 encoder
z
[[0.5 0.5]
 [0.5 0.5]]

u
[[[0.5 0.5]
  [0.5 0.5]]

 [[0.5 0.5]
  [0.5 0.5]]]

v
[[0.5 0.5]
 [0.5 0.5]]

y_categorical
[[0.49999994 0.5       ]]

y_bernoulli
[[0.50000006 0.5       ]
 [0.49999994 0.5       ]]

rho_categorical
[[0.39579403 0.7432217 ]
 [0.34497488 0.7756434 ]]

x_categorical
[[0.3823822  0.76430583]]

x_bernoulli
[[0.6176178  0.23569417]
 [0.3823822  0.76430583]]

z_prime
[[0.5 0.5]
 [0.5 0.5]]

=========================
Layer 1 encoder
z
[[0.5 0.5]
 [0.5 0.5]]

u
[[[0.5 0.5]
  [0.5 0.5]]

 [[0.5 0.5]
  [0.5 0.5]]]

v
[[0.5 0.5]
 [0.5 0.5]]

y_categorical
[[2.1076817e-20 1.0000000e+00]]

y_bernoulli
[[1.0000000e+00 0.0000000e+00]
 [2.1076817e-20 1.0000000e+00]]

rho_categorical
[[0.686289   0.13146237]
 [0.785066   0.63620085]]

x_categorical
[[0.7724438  0.63620085]]

x_bernoulli
[[0.22755623 0.36379915]
 [0.7724438  0.63620085]]

z_prime
[[1.000000e+00 0.000000e+00]
 [7.154564e-20 1.000000e+00]]

====================
Layer 1 decoder
x_bernoulli
[[1. 0.]
 [0. 1.]]

y_bernoulli
[[1.0000000e+00 0.0000000e+00]
 [2.4286297e-19 1.0000000e+00]]

x_categorical
[[0. 1.]]

y_categorical
[[2.4286297e-19 1.0000000e+00]]

v
[[1.009441e-19 6.255333e-01]
 [1.000000e-20 1.000000e+00]]

rho_categorical
[[0.        0.9656186]
 [0.        0.0343814]]

t_categorical
[[[0.0000000e+00 6.0113825e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 5.9336368e-02]
  [0.0000000e+00 5.9925709e-02]
  [0.0000000e+00 5.9207406e-02]
  [0.0000000e+00 5.8634292e-02]
  [0.0000000e+00 6.0053948e-02]
  [0.0000000e+00 5.9794720e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 6.0842555e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 6.0763050e-02]
  [0.0000000e+00 6.1313231e-02]
  [0.0000000e+00 6.0740519e-02]
  [0.0000000e+00 6.1221335e-02]
  [0.0000000e+00 6.0767870e-02]
  [0.0000000e+00 6.1277885e-02]
  [0.0000000e+00 6.0886938e-02]
  [0.0000000e+00 6.0739059e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]]

 [[0.0000000e+00 3.5435800e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 2.9459602e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.4357232e-03]
  [0.0000000e+00 8.5766031e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.2706741e-03]
  [0.0000000e+00 1.1884022e-02]
  [0.0000000e+00 1.1439148e-03]
  [0.0000000e+00 8.0503020e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.4346311e-03]
  [0.0000000e+00 1.2764634e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 6.3790530e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]]]

u
[[[1.0000000e+00 3.7446672e-01]
  [1.0000000e+00 0.0000000e+00]]

 [[1.0094410e-19 6.2553328e-01]
  [9.9999997e-21 1.0000000e+00]]]

z
[[0.37446672 0.        ]
 [0.6255333  1.        ]]

====================
Layer 0 decoder
x_bernoulli
[[0.37446675 0.        ]
 [0.6255332  1.        ]]

y_bernoulli
[[0.49158767 0.        ]
 [0.5084123  1.        ]]

x_categorical
[[0.6255332 1.       ]]

y_categorical
[[0.5084123 1.       ]]

v
[[0.4897553  0.03669661]
 [0.48560855 0.04485285]]

rho_categorical
[[8.4310990e-21 1.0362869e-20]
 [3.8481724e-01 6.1518276e-01]]

t_categorical
[[[6.6306811e-22 8.8841995e-22]
  [0.0000000e+00 7.6253032e-22]
  [0.0000000e+00 6.2911942e-22]
  [1.3419357e-21 1.4720266e-22]
  [7.1553178e-22 2.1552288e-22]
  [8.9902042e-22 6.2022703e-22]
  [1.5862426e-21 2.2427974e-22]
  [7.0641401e-22 2.1328888e-22]
  [1.0757054e-21 8.0710442e-22]
  [1.6143857e-22 6.6824046e-22]
  [5.7534849e-22 4.0989175e-23]
  [0.0000000e+00 7.9109713e-22]
  [9.2317249e-23 3.5063817e-22]
  [0.0000000e+00 4.7587659e-22]
  [0.0000000e+00 1.0972535e-22]
  [1.4226562e-23 2.9957295e-22]
  [0.0000000e+00 8.3321877e-22]
  [0.0000000e+00 1.5367886e-22]
  [6.9142592e-23 1.5653731e-23]
  [5.3070760e-22 3.1079926e-22]
  [0.0000000e+00 5.0216502e-22]
  [0.0000000e+00 4.9255970e-22]
  [0.0000000e+00 8.1095830e-22]]

 [[1.6530355e-21 2.7924590e-21]
  [1.9916171e-01 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.8565555e-01 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.8521481e-01]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.0226667e-02]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.0228412e-02]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.8951290e-01]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]]]

u
[[[0.5102447  0.9633034 ]
  [0.5143914  0.95514715]]

 [[0.4897553  0.03669661]
  [0.48560855 0.04485285]]]

z
[[0.49152046 0.4913195 ]
 [0.50847954 0.50868046]]

--------------------------
--------------------------
Inference example 2
input t
[[[[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]]

  [[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]]]


 [[[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]]

  [[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]]]]
output t
[[6.0113825e-02 1.6879208e-21 1.5545099e-21 5.9336368e-02 5.9925709e-02
  5.9207406e-02 5.8634292e-02 6.0053948e-02 5.9794720e-02 1.7550695e-21
  6.0842555e-02 1.7164876e-21 6.0763050e-02 6.1313231e-02 6.0740519e-02
  6.1221335e-02 6.0767870e-02 6.1277885e-02 6.0886938e-02 6.0739059e-02
  1.4275554e-21 1.4179501e-21 1.7363486e-21]
 [3.5435800e-04 1.9916171e-01 2.9459602e-04 4.5263384e-21 1.4357232e-03
  8.5766031e-04 4.5263384e-21 4.5263384e-21 1.2706741e-03 1.9753957e-01
  1.1439148e-03 2.9326510e-01 4.5263384e-21 1.4346311e-03 1.2764634e-03
  2.0226667e-02 4.5263384e-21 4.5263384e-21 2.0228412e-02 4.5263384e-21
  2.9589194e-01 4.5263384e-21 4.5263384e-21]]

=========================
Layer 0 encoder
z
[[0.5 0.5]
 [0.5 0.5]]

u
[[[0.5 0.5]
  [0.5 0.5]]

 [[0.5 0.5]
  [0.5 0.5]]]

v
[[0.5 0.5]
 [0.5 0.5]]

y_categorical
[[0.49999994 0.5       ]]

y_bernoulli
[[0.50000006 0.5       ]
 [0.49999994 0.5       ]]

rho_categorical
[[5.7085609e-01 1.2016294e-08]
 [3.4497488e-01 7.7564341e-01]]

x_categorical
[[0.51124334 0.5044074 ]]

x_bernoulli
[[0.48875666 0.4955926 ]
 [0.51124334 0.5044074 ]]

z_prime
[[0.5 0.5]
 [0.5 0.5]]

=========================
Layer 1 encoder
z
[[0.5 0.5]
 [0.5 0.5]]

u
[[[0.5 0.5]
  [0.5 0.5]]

 [[0.5 0.5]
  [0.5 0.5]]]

v
[[0.5 0.5]
 [0.5 0.5]]

y_categorical
[[2.1076817e-20 1.0000000e+00]]

y_bernoulli
[[1.0000000e+00 0.0000000e+00]
 [2.1076817e-20 1.0000000e+00]]

rho_categorical
[[1.2437545  0.3193946 ]
 [0.785066   0.63620085]]

x_categorical
[[0.8436797  0.63620085]]

x_bernoulli
[[0.15632027 0.36379915]
 [0.8436797  0.63620085]]

z_prime
[[1.0000000e+00 0.0000000e+00]
 [1.1375418e-19 1.0000000e+00]]

====================
Layer 1 decoder
x_bernoulli
[[1. 0.]
 [0. 1.]]

y_bernoulli
[[1.000000e+00 0.000000e+00]
 [6.139453e-19 1.000000e+00]]

x_categorical
[[0. 1.]]

y_categorical
[[6.139453e-19 1.000000e+00]]

v
[[2.3990207e-19 6.2553328e-01]
 [9.9999997e-21 1.0000000e+00]]

rho_categorical
[[0.        0.9656186]
 [0.        0.0343814]]

t_categorical
[[[0.0000000e+00 6.0113825e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 5.9336368e-02]
  [0.0000000e+00 5.9925709e-02]
  [0.0000000e+00 5.9207406e-02]
  [0.0000000e+00 5.8634292e-02]
  [0.0000000e+00 6.0053948e-02]
  [0.0000000e+00 5.9794720e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 6.0842555e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 6.0763050e-02]
  [0.0000000e+00 6.1313231e-02]
  [0.0000000e+00 6.0740519e-02]
  [0.0000000e+00 6.1221335e-02]
  [0.0000000e+00 6.0767870e-02]
  [0.0000000e+00 6.1277885e-02]
  [0.0000000e+00 6.0886938e-02]
  [0.0000000e+00 6.0739059e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]]

 [[0.0000000e+00 3.5435800e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 2.9459602e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.4357232e-03]
  [0.0000000e+00 8.5766031e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.2706741e-03]
  [0.0000000e+00 1.1884022e-02]
  [0.0000000e+00 1.1439148e-03]
  [0.0000000e+00 8.0503020e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.4346311e-03]
  [0.0000000e+00 1.2764634e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 6.3790530e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]]]

u
[[[1.0000000e+00 3.7446672e-01]
  [1.0000000e+00 0.0000000e+00]]

 [[2.3990207e-19 6.2553328e-01]
  [9.9999997e-21 1.0000000e+00]]]

z
[[0.37446672 0.        ]
 [0.6255333  1.        ]]

====================
Layer 0 decoder
x_bernoulli
[[0.37446675 0.        ]
 [0.6255332  1.        ]]

y_bernoulli
[[0.36399123 0.        ]
 [0.6360088  1.        ]]

x_categorical
[[0.6255332 1.       ]]

y_categorical
[[0.6360088 1.       ]]

v
[[0.6126694  0.03669661]
 [0.607482   0.04485285]]

rho_categorical
[[8.4310990e-21 1.0362869e-20]
 [3.8481724e-01 6.1518276e-01]]

t_categorical
[[[6.6306811e-22 8.8841995e-22]
  [0.0000000e+00 7.6253032e-22]
  [0.0000000e+00 6.2911942e-22]
  [1.3419357e-21 1.4720266e-22]
  [7.1553178e-22 2.1552288e-22]
  [8.9902042e-22 6.2022703e-22]
  [1.5862426e-21 2.2427974e-22]
  [7.0641401e-22 2.1328888e-22]
  [1.0757054e-21 8.0710442e-22]
  [1.6143857e-22 6.6824046e-22]
  [5.7534849e-22 4.0989175e-23]
  [0.0000000e+00 7.9109713e-22]
  [9.2317249e-23 3.5063817e-22]
  [0.0000000e+00 4.7587659e-22]
  [0.0000000e+00 1.0972535e-22]
  [1.4226562e-23 2.9957295e-22]
  [0.0000000e+00 8.3321877e-22]
  [0.0000000e+00 1.5367886e-22]
  [6.9142592e-23 1.5653731e-23]
  [5.3070760e-22 3.1079926e-22]
  [0.0000000e+00 5.0216502e-22]
  [0.0000000e+00 4.9255970e-22]
  [0.0000000e+00 8.1095830e-22]]

 [[1.6530355e-21 2.7924590e-21]
  [1.9916171e-01 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.8565555e-01 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.8521481e-01]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.0226667e-02]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.0228412e-02]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.8951290e-01]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]]]

u
[[[0.3873306  0.9633034 ]
  [0.39251798 0.95514715]]

 [[0.6126694  0.03669661]
  [0.607482   0.04485285]]]

z
[[0.37311688 0.37491244]
 [0.62688315 0.62508756]]

--------------------------
--------------------------
Inference example 1
input t
[[[[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]]

  [[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]]]


 [[[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]]

  [[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]]]]
output t
[[6.0113825e-02 1.6879208e-21 1.5545099e-21 5.9336368e-02 5.9925709e-02
  5.9207406e-02 5.8634292e-02 6.0053948e-02 5.9794720e-02 1.7550695e-21
  6.0842555e-02 1.7164876e-21 6.0763050e-02 6.1313231e-02 6.0740519e-02
  6.1221335e-02 6.0767870e-02 6.1277885e-02 6.0886938e-02 6.0739059e-02
  1.4275554e-21 1.4179501e-21 1.7363486e-21]
 [3.5435800e-04 1.9916171e-01 2.9459602e-04 4.5263384e-21 1.4357232e-03
  8.5766031e-04 4.5263384e-21 4.5263384e-21 1.2706741e-03 1.9753957e-01
  1.1439148e-03 2.9326510e-01 4.5263384e-21 1.4346311e-03 1.2764634e-03
  2.0226667e-02 4.5263384e-21 4.5263384e-21 2.0228412e-02 4.5263384e-21
  2.9589194e-01 4.5263384e-21 4.5263384e-21]]

=========================
Layer 0 encoder
z
[[0.5 0.5]
 [0.5 0.5]]

u
[[[0.5 0.5]
  [0.5 0.5]]

 [[0.5 0.5]
  [0.5 0.5]]]

v
[[0.5 0.5]
 [0.5 0.5]]

y_categorical
[[0.49999994 0.5       ]]

y_bernoulli
[[0.50000006 0.5       ]
 [0.49999994 0.5       ]]

rho_categorical
[[0.7757195  0.64715695]
 [0.34497488 0.7756434 ]]

x_categorical
[[0.6620408 0.7307128]]

x_bernoulli
[[0.33795917 0.26928723]
 [0.6620408  0.7307128 ]]

z_prime
[[0.5 0.5]
 [0.5 0.5]]

=========================
Layer 1 encoder
z
[[0.5 0.5]
 [0.5 0.5]]

u
[[[0.5 0.5]
  [0.5 0.5]]

 [[0.5 0.5]
  [0.5 0.5]]]

v
[[0.5 0.5]
 [0.5 0.5]]

y_categorical
[[2.1076817e-20 1.0000000e+00]]

y_bernoulli
[[1.0000000e+00 0.0000000e+00]
 [2.1076817e-20 1.0000000e+00]]

rho_categorical
[[0.12514405 0.07410514]
 [0.785066   0.63620085]]

x_categorical
[[0.7007376  0.63620085]]

x_bernoulli
[[0.2992624  0.36379915]
 [0.7007376  0.63620085]]

z_prime
[[1.00000e+00 0.00000e+00]
 [4.93524e-20 1.00000e+00]]

====================
Layer 1 decoder
x_bernoulli
[[1. 0.]
 [0. 1.]]

y_bernoulli
[[1.0000000e+00 0.0000000e+00]
 [1.1556107e-19 1.0000000e+00]]

x_categorical
[[0. 1.]]

y_categorical
[[1.1556107e-19 1.0000000e+00]]

v
[[5.3273776e-20 6.2553328e-01]
 [9.9999997e-21 1.0000000e+00]]

rho_categorical
[[0.        0.9656186]
 [0.        0.0343814]]

t_categorical
[[[0.0000000e+00 6.0113825e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 5.9336368e-02]
  [0.0000000e+00 5.9925709e-02]
  [0.0000000e+00 5.9207406e-02]
  [0.0000000e+00 5.8634292e-02]
  [0.0000000e+00 6.0053948e-02]
  [0.0000000e+00 5.9794720e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 6.0842555e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 6.0763050e-02]
  [0.0000000e+00 6.1313231e-02]
  [0.0000000e+00 6.0740519e-02]
  [0.0000000e+00 6.1221335e-02]
  [0.0000000e+00 6.0767870e-02]
  [0.0000000e+00 6.1277885e-02]
  [0.0000000e+00 6.0886938e-02]
  [0.0000000e+00 6.0739059e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]]

 [[0.0000000e+00 3.5435800e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 2.9459602e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.4357232e-03]
  [0.0000000e+00 8.5766031e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.2706741e-03]
  [0.0000000e+00 1.1884022e-02]
  [0.0000000e+00 1.1439148e-03]
  [0.0000000e+00 8.0503020e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.4346311e-03]
  [0.0000000e+00 1.2764634e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 6.3790530e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]]]

u
[[[1.0000000e+00 3.7446672e-01]
  [1.0000000e+00 0.0000000e+00]]

 [[5.3273776e-20 6.2553328e-01]
  [9.9999997e-21 1.0000000e+00]]]

z
[[0.37446672 0.        ]
 [0.6255333  1.        ]]

====================
Layer 0 decoder
x_bernoulli
[[0.37446675 0.        ]
 [0.6255332  1.        ]]

y_bernoulli
[[0.23406404 0.        ]
 [0.76593596 1.        ]]

x_categorical
[[0.6255332 1.       ]]

y_categorical
[[0.76593596 1.        ]]

v
[[0.73782873 0.03669661]
 [0.73158157 0.04485285]]

rho_categorical
[[8.4310990e-21 1.0362869e-20]
 [3.8481724e-01 6.1518276e-01]]

t_categorical
[[[6.6306811e-22 8.8841995e-22]
  [0.0000000e+00 7.6253032e-22]
  [0.0000000e+00 6.2911942e-22]
  [1.3419357e-21 1.4720266e-22]
  [7.1553178e-22 2.1552288e-22]
  [8.9902042e-22 6.2022703e-22]
  [1.5862426e-21 2.2427974e-22]
  [7.0641401e-22 2.1328888e-22]
  [1.0757054e-21 8.0710442e-22]
  [1.6143857e-22 6.6824046e-22]
  [5.7534849e-22 4.0989175e-23]
  [0.0000000e+00 7.9109713e-22]
  [9.2317249e-23 3.5063817e-22]
  [0.0000000e+00 4.7587659e-22]
  [0.0000000e+00 1.0972535e-22]
  [1.4226562e-23 2.9957295e-22]
  [0.0000000e+00 8.3321877e-22]
  [0.0000000e+00 1.5367886e-22]
  [6.9142592e-23 1.5653731e-23]
  [5.3070760e-22 3.1079926e-22]
  [0.0000000e+00 5.0216502e-22]
  [0.0000000e+00 4.9255970e-22]
  [0.0000000e+00 8.1095830e-22]]

 [[1.6530355e-21 2.7924590e-21]
  [1.9916171e-01 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.8565555e-01 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.8521481e-01]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.0226667e-02]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.0228412e-02]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.8951290e-01]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]]]

u
[[[0.26217127 0.9633034 ]
  [0.26841843 0.95514715]]

 [[0.73782873 0.03669661]
  [0.73158157 0.04485285]]]

z
[[0.25255048 0.2563791 ]
 [0.7474495  0.7436209 ]]

--------------------------
--------------------------
Inference example 0
input t
[[[[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]]

  [[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]]]


 [[[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]]

  [[1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e-09 1.e-09]
   [1.e+00 1.e+00]]]]
output t
[[6.0113825e-02 1.6879208e-21 1.5545099e-21 5.9336368e-02 5.9925709e-02
  5.9207406e-02 5.8634292e-02 6.0053948e-02 5.9794720e-02 1.7550695e-21
  6.0842555e-02 1.7164876e-21 6.0763050e-02 6.1313231e-02 6.0740519e-02
  6.1221335e-02 6.0767870e-02 6.1277885e-02 6.0886938e-02 6.0739059e-02
  1.4275554e-21 1.4179501e-21 1.7363486e-21]
 [3.5435800e-04 1.9916171e-01 2.9459602e-04 4.5263384e-21 1.4357232e-03
  8.5766031e-04 4.5263384e-21 4.5263384e-21 1.2706741e-03 1.9753957e-01
  1.1439148e-03 2.9326510e-01 4.5263384e-21 1.4346311e-03 1.2764634e-03
  2.0226667e-02 4.5263384e-21 4.5263384e-21 2.0228412e-02 4.5263384e-21
  2.9589194e-01 4.5263384e-21 4.5263384e-21]]

=========================
Layer 0 encoder
z
[[0.5 0.5]
 [0.5 0.5]]

u
[[[0.5 0.5]
  [0.5 0.5]]

 [[0.5 0.5]
  [0.5 0.5]]]

v
[[0.5 0.5]
 [0.5 0.5]]

y_categorical
[[0.49999994 0.5       ]]

y_bernoulli
[[0.50000006 0.5       ]
 [0.49999994 0.5       ]]

rho_categorical
[[0.29560223 0.8379804 ]
 [0.34497488 0.7756434 ]]

x_categorical
[[0.30863225 0.7974422 ]]

x_bernoulli
[[0.69136775 0.2025578 ]
 [0.30863225 0.7974422 ]]

z_prime
[[0.5 0.5]
 [0.5 0.5]]

=========================
Layer 1 encoder
z
[[0.5 0.5]
 [0.5 0.5]]

u
[[[0.5 0.5]
  [0.5 0.5]]

 [[0.5 0.5]
  [0.5 0.5]]]

v
[[0.5 0.5]
 [0.5 0.5]]

y_categorical
[[2.1076817e-20 1.0000000e+00]]

y_bernoulli
[[1.0000000e+00 0.0000000e+00]
 [2.1076817e-20 1.0000000e+00]]

rho_categorical
[[0.32286385 0.1844291 ]
 [0.785066   0.63620085]]

x_categorical
[[0.7260033  0.63620085]]

x_bernoulli
[[0.2739967  0.36379915]
 [0.7260033  0.63620085]]

z_prime
[[1.0000000e+00 0.0000000e+00]
 [5.5846795e-20 1.0000000e+00]]

====================
Layer 1 decoder
x_bernoulli
[[1. 0.]
 [0. 1.]]

y_bernoulli
[[1.0000000e+00 0.0000000e+00]
 [1.4797607e-19 1.0000000e+00]]

x_categorical
[[0. 1.]]

y_categorical
[[1.4797607e-19 1.0000000e+00]]

v
[[6.541211e-20 6.255333e-01]
 [1.000000e-20 1.000000e+00]]

rho_categorical
[[0.        0.9656186]
 [0.        0.0343814]]

t_categorical
[[[0.0000000e+00 6.0113825e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 5.9336368e-02]
  [0.0000000e+00 5.9925709e-02]
  [0.0000000e+00 5.9207406e-02]
  [0.0000000e+00 5.8634292e-02]
  [0.0000000e+00 6.0053948e-02]
  [0.0000000e+00 5.9794720e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 6.0842555e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 6.0763050e-02]
  [0.0000000e+00 6.1313231e-02]
  [0.0000000e+00 6.0740519e-02]
  [0.0000000e+00 6.1221335e-02]
  [0.0000000e+00 6.0767870e-02]
  [0.0000000e+00 6.1277885e-02]
  [0.0000000e+00 6.0886938e-02]
  [0.0000000e+00 6.0739059e-02]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]
  [0.0000000e+00 9.2539044e-22]]

 [[0.0000000e+00 3.5435800e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 2.9459602e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.4357232e-03]
  [0.0000000e+00 8.5766031e-04]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.2706741e-03]
  [0.0000000e+00 1.1884022e-02]
  [0.0000000e+00 1.1439148e-03]
  [0.0000000e+00 8.0503020e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 1.4346311e-03]
  [0.0000000e+00 1.2764634e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 6.3790530e-03]
  [0.0000000e+00 8.0843961e-23]
  [0.0000000e+00 8.0843961e-23]]]

u
[[[1.0000000e+00 3.7446672e-01]
  [1.0000000e+00 0.0000000e+00]]

 [[6.5412112e-20 6.2553328e-01]
  [9.9999997e-21 1.0000000e+00]]]

z
[[0.37446672 0.        ]
 [0.6255333  1.        ]]

====================
Layer 0 decoder
x_bernoulli
[[0.37446675 0.        ]
 [0.6255332  1.        ]]

y_bernoulli
[[0.5728332  0.        ]
 [0.42716685 1.        ]]

x_categorical
[[0.6255332 1.       ]]

y_categorical
[[0.42716685 1.        ]]

v
[[0.41149127 0.03669661]
 [0.4080072  0.04485285]]

rho_categorical
[[8.4310990e-21 1.0362869e-20]
 [3.8481724e-01 6.1518276e-01]]

t_categorical
[[[6.6306811e-22 8.8841995e-22]
  [0.0000000e+00 7.6253032e-22]
  [0.0000000e+00 6.2911942e-22]
  [1.3419357e-21 1.4720266e-22]
  [7.1553178e-22 2.1552288e-22]
  [8.9902042e-22 6.2022703e-22]
  [1.5862426e-21 2.2427974e-22]
  [7.0641401e-22 2.1328888e-22]
  [1.0757054e-21 8.0710442e-22]
  [1.6143857e-22 6.6824046e-22]
  [5.7534849e-22 4.0989175e-23]
  [0.0000000e+00 7.9109713e-22]
  [9.2317249e-23 3.5063817e-22]
  [0.0000000e+00 4.7587659e-22]
  [0.0000000e+00 1.0972535e-22]
  [1.4226562e-23 2.9957295e-22]
  [0.0000000e+00 8.3321877e-22]
  [0.0000000e+00 1.5367886e-22]
  [6.9142592e-23 1.5653731e-23]
  [5.3070760e-22 3.1079926e-22]
  [0.0000000e+00 5.0216502e-22]
  [0.0000000e+00 4.9255970e-22]
  [0.0000000e+00 8.1095830e-22]]

 [[1.6530355e-21 2.7924590e-21]
  [1.9916171e-01 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.8565555e-01 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.8521481e-01]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.0226667e-02]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.0228412e-02]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.8951290e-01]
  [1.6530355e-21 2.7924590e-21]
  [1.6530355e-21 2.7924590e-21]]]

u
[[[0.5885087  0.9633034 ]
  [0.5919928  0.95514715]]

 [[0.41149127 0.03669661]
  [0.4080072  0.04485285]]]

z
[[0.5669125  0.56544024]
 [0.43308753 0.43455976]]

--------------------------
